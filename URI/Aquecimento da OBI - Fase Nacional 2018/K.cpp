//                                                                                                               `                                                                                        
//                                                                                                                                                                                                        
//                                                                                                                                                                                                        
//                                                                                                              `                                                                                         
//                                                                                                              `               `                                                                         
//                                                                                                                                                                                                        
//                                                                                                             `          `                                                                               
//                                                                                                             `              `                                                                           
//                                                                                                                       `                                                                                
//                                                                                                            `         `                                                                                 
//                                                                                                            `                                                                                           
//                                                                                                           .         `                                                                                  
//                                                                                                                    `   `                                                                               
//                                                                                                          .            `                                                                                
//                                                                                                                   `  `                                                                                 
//                                                                                                         `        .  `                                                                                  
//                                                                                                         `       `  `                                                                                   
//                                                                                                        .          `                                                                                    
//                                                                                                       `          `                                                                                     
//                                                                                                               ` `                                                                                      
//                                                                                                      `       `                                                                                         
//                                                                                                     `       ``                                                                                         
//                                                                                                    .       `,                                                                                          
//                                                                                                   ,        ,                                                                                           
//                                                                                                  .       ..                                                                                            
//                                                                                                 ,       .` `                                                                                           
//                                                                                                ,`     ``..                                                                                             
//                                                                                              ```    ```.                                                                                               
//                                                                                             .`.   . ..`                                                                                                
//                                                                                           `  `  ` `..                                                                                                  
//                                                                                         `.  `,;,,`. `                                                                                                  
//                                                                                      ```,,;;::` ..                                                                                                     
//                                                                       ``...`      `,, `:`,,;:,``                                                                                                       
//                                                                 `.,:.`       `,,.;;;:..::.`.,,`                                                                                                        
//                                                             `.,;;::.   `.::;;;;;:::;,;,,,,.```                                                                                                         
//                                                          `.,;';;;:::::;;;;;::::;:;;:,.``                                                                                                               
//                                                    `.,:,,;;::,,:::::::;;;;;;:,,:,::,.```                                                                                                               
//                                                 `.,:,,,,,::,::::::::::::::,:,.,.```                                                                                                                    
//                                              `...,,,,.,,,:,:::,::;:,::::,::::;;,``                                                                                                                     
//                                            `.........,,,:,,:,,,,,:::::,,.`.````,,,:;.                                                                                                                  
//                                          ``........,,..,,,,,,,:::'''';;;::.```     ` .,.                                                                                                               
//                                        ``...........,,.,,,,,,,,::;;;;;;''''';,..`       ````                                                                                                           
//                                       ```..............,:,,::;;''''';;:;;;;;;:';;   `           `                                                                                                      
//                                     ``````..`...........,,::;::;;;'';'';:;;;;:..:`...```           ``                                                                                                  
//                                   ``````````..........,,,:,:,::::;;;;;;;;;:;;'+,,`.` ..                                                                                                                
//                                  ````````````..........,,,,,,,:,:::::;;;';;;:;;:,;.` ` ```                                                                                                             
//                                 ````````````............,.,,,,,:;;;;;'''''''';:;, `.`         `                                                                                                        
//                                ````````````............,..,.,,,,::,::;''''''''';',  `                                                                                                                  
//                               ````````````````.``.........,.,.,,,::,:::;;;'''''+;',  `                                                                                                                 
//                              ````````````````.```..............,,:;;;;;';;;;;;''';':                                                                                                                   
//                              ````````````````.````...............:;:::::::'''';;:,;';                                                                                                                  
//                             `````````````````````........,.........,,,:'';;;+''';'';;;`                                                                                                                
//                            ````````````````````.`......,............,,,:;;'''''''''';;:`                                                                                                               
//                            ```````````````````.`......,....,...,......,,,,::;;:::'+''';:`                                                                                                              
//                           `` `````````````````..`....,..,..,.`.,.......,,,,,,,,,,:;'''';:                                                                                                              
//                           `````````````````````.`.....,,,,,,.,,,,......,,,...,,,,:;;;''';:                                                                                                             
//                           `  ``````````````````.`...,.,,,:::;;;,,:....,,,..,.,,,::;;';''';:                                                                                                            
//                           ```````````````````````.,..,:,;::;:';:,::...,,...,,,,,,::;;''''';,                                                                                                           
//                           ````````````.`````````.,.`.,;:;:,:;;':,,,..,,,,,,,,,..,,::;;;'''';.                                                                                                          
//                           ``````..````.`````..``.,``.;';,;+##++;:,:,,,,,,,,,,,..,,:;;;;;;'';;`                                                                                                         
//                           `.````....`....`.`..`.,,`.,;':+##+#++;;:,:,,,,,,,,,,...,,,;;;;;;'';:                                                                                                         
//                           ```````....`,....`,...,...:';+;####+++;;:::,.,,,,,,......,,:;;;;'';;.                                                                                                        
//                           ``.````.....,.,,,.,..,,`.,'''::####+++';;:,,,,,,,,,,,....,,,:;;;;'';:                                                                                                        
//                          ``.````..`...,,,:,.,,:,,,.:';+,:####+++''';::,,,,:,:,,.....,,:::;;'';;:                                                                                                       
//                          ```.``.''.`..,,,:,,,:::,.,:';+,;####+++'';::,,,::;::;:,.....,,.:;;;:::;.                                                                                                      
//                          ``````:';..,,,::,:,:;::,:,:;;++#####+++'';,:,::;;;:;;::::,......,:::;;;:`                                                                                                     
//                          .```.`.';..,.:,::;::;;,,,,,:;+######++#';:::::;;;;;;::::::,....,,,::;;;;:                                                                                                     
//                           ````.`.,..,,,;:':::;::,,,,;:'########+'::::;;';;:;;:::::::,,...,::;;'';;,                                                                                                    
//                           ` ``...,,,:,,;;':,;;:::,,::;:++######'',:;;;;;;;:;;;;;;;::,,....,,:;;;;':`                                                                                                   
//                           `````..,,,::,;;';';':,,,,,:::,'####+'';:;;;:;;;;''';';;';;:,,,.,,,,:;;;':.                                                                                                   
//                          `...`...,:::,:;;;;::;..,,,,,::::;;;;;';,::;;;;;''''';;;';;;;:,,..,,,,::'';:                                                                                                   
//                          .`.,,`,:::::,:;;;:,;,.,,;,:::;;;::;;'::;;;;;;;'';;';;;:;:::;:,,...,,:;:''';.                                                                                                  
//                          ,`,,,,`.:,,,,::;;,,,.,.,,;.,,:,:;:::::;::;;;;';';;;;;:,::,,::,,...,,::;;''':                                                                                                  
//                          .`,,::,,,....,:;...,.....,.:,,,,,.,,::::::;::;;;;:::::::::,:::,...,,,::'''';,                                                                                                 
//                         ``.,::,,,.,,,,.,:..,...`.`.,,,,,.,::;.,,,:;;;;;''';;;;;;;;;:::::,..,,,::'''';;`                                                                                                
//                         .`,,,::,,,,..,:,:,`.,.,.`.`.,..:,,..,,,:::;;;;;;;;;::;;;;;::::::,,...,,:;'''';:                                                                                                
//                         ,`,:::,,,,,..,,,:,``,..`.`..,...,.`..,,,,::;::::;;;;;:;;;;;;:::,,....,,:;;''';;`                                                                                               
//                         ,.:::;:,,,,..,,,,,.`..```.``...,..,,.....,,::::,:;;';;;;;;::::,,,......:;''''';:                                                                                               
//                         ,.::;;;:,,,.,,,,:...`.`,``...`.......,.,,,,,:::::;;;;;;;;';;;;;:,,....,:;'''''';.                                                                                              
//                         .,:.:;;;::,.,,,,:.`````.```,.``.`.,.....,,,:;;:::;;''';'''''';:,,.....,,;'+'''';:                                                                                              
//                         .,:::;;;::,,.,,,:.````````...``````......,,::::::::;;;::;;;;;::,,.....,,:''+'''';,                                                                                             
//                         ,,:;;;;:::,,.,,,,.`````````.`.`.````.....,,,,,:;:;::::;;;;;;::::,,....,,:;''''''':`                                                                                            
//                         ,,:;;;;:::..:,,,,.`````````.`.`..```....,,,::::;::;;;:::;;;;:::::,....,:;;;++'''';:                                                                                            
//                         ,:::;;;::::,::,,,```````````..``........,:::::;;:;;;;;::;';;;;;::,....::;''''''''';.                                                                                           
//                         ,::;;;;:,:::::,.````````````..```.......,::::::;;;:::;;;:;';;;;;:,....,;;'''+''''';;`                                                                                          
//                         ,::;;;;:;:;:::`..```````````...```...`...,,:;;;::::::;;;;;;:;;;;:,...,,;'''++'''''':,`                                                                                         
//                         :::;;';':;;;:`...``````````````````......,,:;;::::;:;::;;;;;;;::,,...,:;''''++'''''';,                                                                                         
//                         ,::;;';;':,...,..`````````````````.......,,,,;:::::::;;;::::::,,,..,,:::';''++'''''';:.                                                                                        
//                         ,::;;';;+;,..,,,,``````````````..........,,,,,;::;:;;;;:::::;:,....,,,;;;'''''''''''';:`                                                                                       
//                         .;;;'';;;;;:,,,,.`````````````............,,,,,:;,:;;;;:::::::,....,,::;;'''''''''''';;:                                                                                       
//                          ;;;;;;+,:;::,,,`````````````............,.,,,,,,::::::::,,,,,,....,,::;;'+''''''''''';;,                                                                                      
//                          :;;;:;+::::;:::```````````............`....,,.,,,:,:,,,,,,.........,,:';'''''''''''''';;.                                                                                     
//                          .:::,;''::;;:::``````````....................,.,,,,,,,,.............,:''''''''''''''''';:.                                                                                    
//                           ,,,,:`;;;;;;:.`.```````........................,,,.,,,..```````....,,';'''''''''''''''';;`                                                                                   
//                           .,,:,  :';;;:.``.``````...`.....................,..,...``````.``...,,:;''''''''''''''''';:`                                                                                  
//                            ,.,,   .;;;,.....`````...`.......`````..................```````...,,;;'''''''''''''''''';:`                                                                                 
//                            `.',   .,:::......`````..``......``````.............```````````.`.,,:;'''''''''''''''''';;,                                                                                 
//                             ,::   `.,,:......``````.``......``````.............``````````.....,:;;''''''''''''''''';;;,                                                                                
//                              ::    .,,:.......``.``.````....````................`````````...,,.:;'''''''';'''''''''';;:,                                                                               
//                               .    `,,,......```.``..```....````..`........`..````````````...,,,;;'''''''';''''''''';;;:.
//                                     .,.,......`````````......````.........````.`..```.`.``...,,:,;''''''';''''''''''';;;:.
//                                     `.........``````.``......````.`.......`````..````..`......,:::';''''''';'''''''''';;;,.
//                                      ...,....```````.````....```........```````...```.```....,,:::;''''''';';'''''''''''';,.
//                                      `.......``.````.````.....```..`..`...``````..````......,,,:::;;'''';;';'''''''''''''';,`
//                                      ```.....```````.`````....```.....``..```````````........,,:;:;''''''''';'''''''''''''';,
//                                       ``.....```````.`````......`...````.````````````.......,.:::;;'''''';;';'''''''''''''';:,
//                                       ``.....```````..````......`.....````````````.`........,:,;::;;'''';''''''''''''''''';';:,
//                                       ```....```````..`````.......`..``.```````````.`.....,.,:::;;;'''''''''''''''''''''''';;;,.
//                                       ````...```````...`````.`...``...````````......`......,,::;:''''''';;;''''''''''''''''';;:..
//                                        ```...```````...`````....``.```.````.`...`.....`..,,::::;';''''';;';;';'''''''''''''''';:,`
//                                        ```.`````````...`````.....```...````.`....`....,.,,,,::;;''''''';;';;''';''''''''''''''';:.`
//                                        ```...``````....`````.....```````````..`.........,:::;:;;'+'';;'';'';;;''''''''''''''''';;:.
//                                         ```..``````....````......``````.```....,.....,,,,,;:;'''''''';';;;';;';'''''''''''''''''';:`
//                                         ````.``````....``.`......````.``````.....`..,,:;:;::;';''''';';;;;;';''''''''''''''''''''';:`
//                                          ````````.`.....``........`````````..,..,..,,:::;,'';;'';;';;;;;;;;;'''''''''''''''''''''';;,`
//                                          ```.`.``.......`......`````````.```...,,,.,,,::'';;;;'';;;;;;;;;;;;'''''''''''''''+''''''';:.
//                                           ````.``......```...``````.``.`.``...,,,:,,,;:;;;';;';';;;;';;;;;;'''''''''''''''''+''''''';:.
//                                           ````..`......``.....`.`.`.`.`...`...:,,,,::;;:;;';;;;;;;;'';;';';;''''''''''+''''''+''''''';:`
//                                           ```..........``.....`.`.```.......,,:::,;;;;;:;;;;;;;'';'';;;;;;';';'''''''''''''+'++''''''';,
//                                            `...........``.....```.......,.,.,::,:::;;;;;;';;;;;;';''';;';;';''''''''''''+'+''+''''''''';,
//                                            `...........`.....,.``,,,.,...,:,:::;::::;;;;'''';;;';''';';;;'';''''''''''''+''''''''''''';;:.
//                                            `.....,...........,...,,,.:.,,,,;:::;:;,:;;;';';';;';''';'';'';''''''+''''''''+'+'''''''''';;:,`
//                                            `.....,.........,..,.,,,,.:,,,:,:;::::;::;;;';;;';''''';'';'''''''''''''''''''++''''''''''''';:.
//                                            ...............,:.,,,,,:,,,;:::,::;:;::;:;;;;;;;;'';'''';;'';''''''''+'''''''''''''''''''''''';:.
//                                            ....,...,,,,.,,,:,,,::,::::;,::::;;::::::;;:;;;;;;;';';;;;'''''+'+''''''''+++''+'''''''''''';'';,.

#include <bits/stdc++.h>
#define DEBUG false
#define debugf if (DEBUG) printf
#define MAXN 100309
#define MAXM 900009
#define ALFA 256
#define MOD 1000000007
#define INF 0x3f3f3f3f
#define INFLL 0x3f3f3f3f3f3f3f3f
#define EPS 1e-9
#define PI 3.141592653589793238462643383279502884
#define FOR(x,n) for(int x=0; (x)<int(n); (x)++)
#define FOR1(x,n) for(int x=1; (x)<=int(n); (x)++)
#define REP(x,n) for(int x=int(n)-1; (x)>=0; (x)--)
#define REP1(x,n) for(int x=(n); (x)>0; (x)--)
#define pb push_back
#define pf push_front
#define fi first
#define se second
#define mp make_pair
#define sz(x) int(x.size())
#define all(x) x.begin(), x.end()
#define mset(x,y) memset(&x, (y), sizeof(x));
using namespace std;
typedef long long ll;
typedef unsigned long long ull;
typedef long double ld;
typedef unsigned int uint;
typedef vector<int> vi;
typedef pair<int, int> ii;

class SparseTable{
private:
	vector<vi> st;
	int sz;
public:
	SparseTable() {}
	SparseTable(const vector<int> &a) {
		sz = sz(a);
		int logn = 1;
		for(; 1 << logn <= sz; logn++);
		st.assign(sz, vi(logn));
		for(int i=0; i<sz; i++) st[i][0] = a[i];
		for(int j = 1; 1 << j <= sz; j++)
			for(int i=0; i + (1<<j) <= sz; i++)
				st[i][j] = max(st[i][j-1], st[i+(1<<(j-1))][j-1]);
	}
	int query(int l, int r) {
		if (r < l) return 0;
		int k = (int)floor(log((double)r-l+1) / log(2.0)); // 2^k <= (j-i+1)
		return max(st[l][k], st[r-(1<<k)+1][k]);
	}
};

SparseTable sonst[MAXN], chainst[MAXN];
int par[MAXN], parg[MAXN], size[MAXN];
vector<int> g[MAXN];
int root, up[MAXN], fson[MAXN];
vector<int> chain[MAXN];
int nchs, nchain[MAXN], id[MAXN], depth[MAXN], height[MAXN];

inline int downh(int u) {
	return height[u];
}

inline int downh_except(int u, int v) {
	if (v == -1) return downh(u);
	int i = parg[v];
	return max(sonst[u].query(0, i-1), sonst[u].query(i+1, sz(g[u])-1));
}

inline int downh_except(int u, int v, int w) {
	if (v == -1) return downh_except(u, w);
	int i = parg[v], j = parg[w];
	if (i > j) swap(i, j);
	return max(
		max(sonst[u].query(0, i-1), sonst[u].query(i+1, j-1)),
		sonst[u].query(j+1, sz(g[u])-1)
	);
}

void sizedfs(int u) {
	//printf("dfs %d\n", u);
	size[u] = 1;
	height[u] = 0;
	fson[u] = -1;
	int msz = 0;
	vi h(g[u].size());
	FOR(i, sz(g[u])) {
		int v = g[u][i];
		if (v == par[u]) {
			h[i] = 0;
			continue;
		}
		par[v] = u;
		parg[v] = i;
		sizedfs(v);
		size[u] += size[v];
		height[u] = max(height[u], 1 + height[v]);
		h[i] = 1 + height[v];
		if (size[v] > msz) {
			fson[u] = v;
			msz = size[v];
		}
	}
	//printf("size[%d] = %d, height[%d] = %d\n", u, size[u], u, height[u]);
	sonst[u] = SparseTable(h);
	//printf("st for %d built\n", u);
}

int uph[MAXN];
void uphdfs(int u, int h) {
	uph[u] = h;
	//printf("uph[%d] = %d\n", u, uph[u]);
	for(int v : g[u]) {
		if (v == par[u]) continue;
		uphdfs(v, 1+max(h, downh_except(u, v)));
	}
}

void builddfs(int u, int ch, int h) {
	nchain[u] = ch;
	id[u] = chain[ch].size();
	chain[ch].push_back(u);
	//printf("%d to chain %d\n", u, ch);
	for(int v : g[u]) {
		if (v == par[u]) continue;
		if (v == fson[u]) builddfs(v, ch, h+1);
		else {
			up[nchs] = u;
			depth[nchs] = h;
			chain[nchs].clear();
			builddfs(v, nchs++, h+1);
		}
	}
}

void heavylightdecomposition(int _root) {

	//preproccess
	root = _root;
	par[root] = -1;
	//printf("beggining size dfs\n");
	sizedfs(root);
	//printf("beggining uph dfs\n");
	uphdfs(root, 0);

	//hld
	nchs = 0;
	chain[0].clear();
	up[nchs] = -1;
	depth[nchs] = 0;
	//printf("building hld\n");
	builddfs(root, nchs++, 1);

	//build sts
	vi down;
	FOR(c, nchs) {
		down.resize(chain[c].size());
		FOR(i, sz(down)) {
			int u = chain[c][i];
			down[i] = downh_except(u, fson[u]);
		}
		chainst[c] = SparseTable(down);
	}
}

int query(int u, int v) {
	int cu = nchain[u], cv = nchain[v];
	int ans = 0;
	int du = -1, dv = -1;
	while(cu != cv) {
		if (depth[cv] > depth[cu]) {
			swap(u, v);
			swap(cu, cv);
			swap(du, dv);
		}
		//printf("moving %d up\n", u);
		ans = max(ans, downh_except(u, du));
		ans = max(ans, chainst[cu].query(0, id[u]-1));
		du = chain[cu][0];
		u = up[cu];
		cu = nchain[u];
	}
	if (id[u] != id[v]) {
		if (id[u] < id[v]) {
			swap(u, v);
			swap(cu, cv);
			swap(du, dv);
		}
		ans = max(ans, downh_except(u, du));
		//printf("path %d-%d\n", chain[cu][id[v]+1], chain[cu][id[u]-1]);
		ans = max(ans, chainst[cu].query(id[v]+1, id[u]-1));
		du = chain[cu][id[v]+1];
		u = v;
	}
	assert(du != dv);
	ans = max(ans, downh_except(u, du, dv));
	ans = max(ans, uph[u]);
	return ans;
}

int main() {
	int T;
	scanf("%d", &T);
	FOR1(caseNo, T) {
		int n;
		scanf("%d", &n);
		FOR(u, n) g[u].clear();
		FOR(j, n-1) {
			int u, v;
			scanf("%d %d", &u, &v);
			g[u].pb(v);
			g[v].pb(u);
		}
		heavylightdecomposition(0);
		int q;
		scanf("%d", &q);
		FOR(j, q) {
			int u, v;
			scanf("%d %d", &u, &v);
			printf("%d\n", query(u, v));
		}
	}
	return 0;
}