#define MOD 1000000007
class Solution {
private:
    int powers2[500] = {1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152, 4194304, 8388608, 16777216, 33554432, 67108864, 134217728, 268435456, 536870912, 73741817, 147483634, 294967268, 589934536, 179869065, 359738130, 719476260, 438952513, 877905026, 755810045, 511620083, 23240159, 46480318, 92960636, 185921272, 371842544, 743685088, 487370169, 974740338, 949480669, 898961331, 797922655, 595845303, 191690599, 383381198, 766762396, 533524785, 67049563, 134099126, 268198252, 536396504, 72793001, 145586002, 291172004, 582344008, 164688009, 329376018, 658752036, 317504065, 635008130, 270016253, 540032506, 80065005, 160130010, 320260020, 640520040, 281040073, 562080146, 124160285, 248320570, 496641140, 993282280, 986564553, 973129099, 946258191, 892516375, 785032743, 570065479, 140130951, 280261902, 560523804, 121047601, 242095202, 484190404, 968380808, 936761609, 873523211, 747046415, 494092823, 988185646, 976371285, 952742563, 905485119, 810970231, 621940455, 243880903, 487761806, 975523612, 951047217, 902094427, 804188847, 608377687, 216755367, 433510734, 867021468, 734042929, 468085851, 936171702, 872343397, 744686787, 489373567, 978747134, 957494261, 914988515, 829977023, 659954039, 319908071, 639816142, 279632277, 559264554, 118529101, 237058202, 474116404, 948232808, 896465609, 792931211, 585862415, 171724823, 343449646, 686899292, 373798577, 747597154, 495194301, 990388602, 980777197, 961554387, 923108767, 846217527, 692435047, 384870087, 769740174, 539480341, 78960675, 157921350, 315842700, 631685400, 263370793, 526741586, 53483165, 106966330, 213932660, 427865320, 855730640, 711461273, 422922539, 845845078, 691690149, 383380291, 766760582, 533521157, 67042307, 134084614, 268169228, 536338456, 72676905, 145353810, 290707620, 581415240, 162830473, 325660946, 651321892, 302643777, 605287554, 210575101, 421150202, 842300404, 684600801, 369201595, 738403190, 476806373, 953612746, 907225485, 814450963, 628901919, 257803831, 515607662, 31215317, 62430634, 124861268, 249722536, 499445072, 998890144, 997780281, 995560555, 991121103, 982242199, 964484391, 928968775, 857937543, 715875079, 431750151, 863500302, 727000597, 454001187, 908002374, 816004741, 632009475, 264018943, 528037886, 56075765, 112151530, 224303060, 448606120, 897212240, 794424473, 588848939, 177697871, 355395742, 710791484, 421582961, 843165922, 686331837, 372663667, 745327334, 490654661, 981309322, 962618637, 925237267, 850474527, 700949047, 401898087, 803796174, 607592341, 215184675, 430369350, 860738700, 721477393, 442954779, 885909558, 771819109, 543638211, 87276415, 174552830, 349105660, 698211320, 396422633, 792845266, 585690525, 171381043, 342762086, 685524172, 371048337, 742096674, 484193341, 968386682, 936773357, 873546707, 747093407, 494186807, 988373614, 976747221, 953494435, 906988863, 813977719, 627955431, 255910855, 511821710, 23643413, 47286826, 94573652, 189147304, 378294608, 756589216, 513178425, 26356843, 52713686, 105427372, 210854744, 421709488, 843418976, 686837945, 373675883, 747351766, 494703525, 989407050, 978814093, 957628179, 915256351, 830512695, 661025383, 322050759, 644101518, 288203029, 576406058, 152812109, 305624218, 611248436, 222496865, 444993730, 889987460, 779974913, 559949819, 119899631, 239799262, 479598524, 959197048, 918394089, 836788171, 673576335, 347152663, 694305326, 388610645, 777221290, 554442573, 108885139, 217770278, 435540556, 871081112, 742162217, 484324427, 968648854, 937297701, 874595395, 749190783, 498381559, 996763118, 993526229, 987052451, 974104895, 948209783, 896419559, 792839111, 585678215, 171356423, 342712846, 685425692, 370851377, 741702754, 483405501, 966811002, 933621997, 867243987, 734487967, 468975927, 937951854, 875903701, 751807395, 503614783, 7229559, 14459118, 28918236, 57836472, 115672944, 231345888, 462691776, 925383552, 850767097, 701534187, 403068367, 806136734, 612273461, 224546915, 449093830, 898187660, 796375313, 592750619, 185501231, 371002462, 742004924, 484009841, 968019682, 936039357, 872078707, 744157407, 488314807, 976629614, 953259221, 906518435, 813036863, 626073719, 252147431, 504294862, 8589717, 17179434, 34358868, 68717736, 137435472, 274870944, 549741888, 99483769, 198967538, 397935076, 795870152, 591740297, 183480587, 366961174, 733922348, 467844689, 935689378, 871378749, 742757491, 485514975, 971029950, 942059893, 884119779, 768239551, 536479095, 72958183, 145916366, 291832732, 583665464, 167330921, 334661842, 669323684, 338647361, 677294722, 354589437, 709178874, 418357741, 836715482, 673430957, 346861907, 693723814, 387447621, 774895242, 549790477, 99580947, 199161894, 398323788, 796647576, 593295145, 186590283, 373180566, 746361132, 492722257, 985444514, 970889021, 941778035, 883556063, 767112119, 534224231, 68448455, 136896910, 273793820, 547587640, 95175273, 190350546, 380701092, 761402184, 522804361, 45608715, 91217430, 182434860, 364869720, 729739440, 459478873, 918957746, 837915485, 675830963, 351661919, 703323838, 406647669, 813295338, 626590669, 253181331, 506362662, 12725317, 25450634, 50901268, 101802536, 203605072, 407210144, 814420288, 628840569, 257681131, 515362262, 30724517, 61449034, 122898068, 245796136, 491592272, 983184544, 966369081, 932738155, 865476303, 730952599, 461905191, 923810382, 847620757, 695241507};
public:
    vector<int> productQueries(int n, vector<vector<int>>& queries) {
        

        vector<long long> powers;
        for(int p = 0; n > 0; n >>= 1, p++) {
            if (n & 1) {
                powers.push_back(p);
            }
        }
        for (int i = 1; i < (int)powers.size(); i++) {
            powers[i] += powers[i-1];
        }
        vector<int> ans(queries.size());
        for (int q = 0; q < (int)queries.size(); q++) {
            int l = queries[q][0];
            int r = queries[q][1];
            int p = powers[r];
            if (l > 0) {
                p -= powers[l-1];
            }
            ans[q] = powers2[p];
        }
        return ans;
    }
};
